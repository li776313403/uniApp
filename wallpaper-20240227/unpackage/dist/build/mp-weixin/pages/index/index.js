"use strict";const e=require("../../common/vendor.js"),a=require("../../api/wallpaper.js"),o=require("../../stores/dataStore.js"),r=require("../../unit/basicData.js"),t=require("../../unit/queryAndParamHelper.js");if(require("../../unit/request.js"),!Array){(e.resolveComponent("CustomNavBar")+e.resolveComponent("uni-icons")+e.resolveComponent("uni-dateformat")+e.resolveComponent("CommonTitle")+e.resolveComponent("ThemeItem"))()}Math||((()=>"../../components/CustomNavBar/CustomNavBar.js")+(()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../uni_modules/uni-dateformat/components/uni-dateformat/uni-dateformat.js")+(()=>"../../components/CommonTitle/CommonTitle.js")+(()=>"../../components/ThemeItem/ThemeItem.js"))();const s=e.defineComponent({__name:"index",setup(s){const n=o.useDataStore(),i=e.ref({banner:[],wallNews:[],dailyPromotion:[]}),l=e.computed({get:()=>n.classify.slice(0,8),set:e=>n.setClassifyData(e)});return e.onLoad((()=>{a.getHomeBanner().then((a=>{0===a.errCode?i.value.banner=a.data.sort((e=>e.sort)):(e.index.showToast({title:"获取banner数据失败",icon:"error"}),console.error("获取banner数据失败",a.errMsg))})).catch((a=>{e.index.showToast({title:"获取banner数据失败",icon:"error"}),console.error("获取banner数据失败",a)})),a.getWallNews({select:!0,pageNum:1,pageSize:3}).then((a=>{0===a.errCode?i.value.wallNews=a.data:(e.index.showToast({title:"获取壁纸资讯公告数据失败",icon:"error"}),console.error("获取壁纸资讯公告数据失败",a.errMsg))})).catch((a=>{e.index.showToast({title:"获取壁纸资讯公告数据失败",icon:"error"}),console.error("获取壁纸资讯公告数据失败",a)})),a.getDailyPromotion().then((a=>{0===a.errCode?i.value.dailyPromotion=a.data:(e.index.showToast({title:"获取每日推介数据失败",icon:"error"}),console.error("获取每日推介数据失败",a.errMsg))})).catch((a=>{e.index.showToast({title:"获取每日推介数据失败",icon:"error"}),console.error("获取每日推介数据失败",a)})),a.getClassify({select:!1,pageNum:1,pageSize:20}).then((a=>{0===a.errCode?l.value=a.data.sort((e=>e.sort)):(e.index.showToast({title:"获取壁纸分类数据失败",icon:"error"}),console.error("获取壁纸分类数据失败",a.errMsg))})).catch((a=>{e.index.showToast({title:"获取壁纸分类数据失败",icon:"error"}),console.error("获取壁纸分类数据失败",a)}))})),e.onShareAppMessage((()=>({title:r.basicData.title,path:"/pages/index/index"}))),e.onShareTimeline((()=>({title:r.basicData.title}))),(a,o)=>({a:e.f(i.value.banner,((a,o,s)=>({a:a.picurl,b:a._id,c:e.o((o=>(a=>{if(a.target===r.basicData.enumeration.bannerTarget.self){const o=t.queryAndParamHelper.param2Obj(a.url);e.index.navigateTo({url:"/pages/classList/classList?classId="+o.id})}else e.index.navigateToMiniProgram({appId:a.appid})})(a)),a._id)}))),b:e.p({type:"sound-filled",size:"20"}),c:e.f(i.value.wallNews,((a,o,r)=>({a:e.t(a.title),b:a._id,c:e.o((o=>{return r=a,void e.index.navigateTo({url:"/pages/notice/detail?id="+r._id});var r}),a._id)}))),d:e.p({type:"right",size:"20"}),e:e.p({type:"calendar",size:"20"}),f:e.p({date:Date.now(),format:"dd日"}),g:e.f(i.value.dailyPromotion,((a,o,r)=>({a:a.smallPicurl,b:a._id,c:e.o((o=>(a=>{const o=l.value.filter((e=>e._id===a.classid)),r={classId:a.classid,className:"未知分类",wallId:a._id};o.length>0?(r.className=o[0].name,e.index.navigateTo({url:"/pages/classList/classList?"+t.queryAndParamHelper.tansParams(r)})):e.index.navigateTo({url:"/pages/preview/preview?"+t.queryAndParamHelper.tansParams(r)})})(a)),a._id)}))),h:e.f(l.value,((a,o,r)=>({a:a._id,b:"89d788ae-7-"+r,c:e.p({classIfy:a})}))),i:e.p({isMore:!0})})}});s.__runtimeHooks=6;const n=e._export_sfc(s,[["__scopeId","data-v-89d788ae"]]);wx.createPage(n);
